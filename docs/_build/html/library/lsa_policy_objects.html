

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>LSA Policy Objects &#8212; Threat Hunter Playbook</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/mystnb.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .secondtoggle, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script async="async" src="../_static/thebelab.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="canonical" href="https://threathunterplaybook.com/library/lsa_policy_objects.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">
<!-- Put requirejs at the end so it's always after bootstrap -->
<!-- TODO: remove this once https://github.com/pandas-dev/pydata-sphinx-theme/pull/149 is merged -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script>


<!-- Opengraph tags -->
<meta property="og:url"         content="https://threathunterplaybook.com/library/lsa_policy_objects.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="LSA Policy Objects" />
<meta property="og:description" content="LSA Policy Objects  The LSA stores local security policy information in a set of objects. Your application can query or edit the local security policy by access" />
<meta property="og:image"       content="https://threathunterplaybook.com/_static/logo.png" />

<meta name="twitter:card" content="summary">


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          

<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Threat Hunter Playbook</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  
  <ul class="nav sidenav_l1">
<li class="navbar-special">
<p class="margin-caption">Pre-Hunt Activities</p>
</li>
  <li class="">
    <a href="../pre-hunt/data_management.html">Data Management</a>
  </li>
<li class="navbar-special">
<p class="margin-caption">Campaign Notebooks</p>
</li>
  <li class="">
    <a href="../evals/intro.html">ATT&CK Evaluations</a>
  </li>
<li class="navbar-special">
<p class="margin-caption">Targeted Notebooks</p>
</li>
  <li class="">
    <a href="../notebooks/windows/windows.html">Windows</a>
  </li>
  <li class="">
    <a href="../notebooks/linux/linux.html">Linux</a>
  </li>
  <li class="">
    <a href="../notebooks/mac/mac.html">Mac</a>
  </li>
</ul>
</nav>
<p class="navbar_footer">Powered by <a href="https://jupyterbook.org">Jupyter Book</a></p>
</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse" data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu" aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation" title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i class="fas fa-download"></i></button>

            
            <div class="dropdown-buttons">
                <!-- ipynb file if we had a myst markdown file -->
                
                <!-- Download raw file -->
                <a class="dropdown-buttons" href="../_sources/library/lsa_policy_objects.md.txt"><button type="button" class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip" data-placement="left">.md</button></a>
                <!-- Download PDF via print -->
                <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF" onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
            </div>
            
        </div>

        <!-- Edit this page -->
        <a class="edit-button" href="https://github.com/hunters-forge/ThreatHunter-Playbook/edit/master/docs/library/lsa_policy_objects.md"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="bottom" title="Edit this page"><i class="fas fa-pencil-alt"></i></button></a>

        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->
        

        
    </div>
    <div class="d-none d-md-block col-md-2 bd-toc show">
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#policy-object" class="nav-link">Policy Object</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#trusteddomain-object" class="nav-link">TrustedDomain Object</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#account-object" class="nav-link">Account Object</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#private-data-object" class="nav-link">Private Data Object</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#local-private-data-objects-l" class="nav-link">Local private data objects (L$)</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#global-private-data-objects-g" class="nav-link">Global private data objects (G$)</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#machine-private-data-objects-m" class="nav-link">Machine private data objects (M$)</a>
        </li>
    
            </ul>
        </li>
    
    </ul>
</nav>



<div class="tocsection editthispage">
    <a href="https://github.com/hunters-forge/ThreatHunter-Playbook/edit/master/docs/library/lsa_policy_objects.md">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 col-xxl-7 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="lsa-policy-objects">
<h1>LSA Policy Objects<a class="headerlink" href="#lsa-policy-objects" title="Permalink to this headline">¶</a></h1>
<p>The LSA stores local security policy information in a set of objects. Your application can query or edit the local security policy by accessing these objects.</p>
<p>The set consists of the following four objects:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Policy</span></code> contains global policy information.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TrustedDomain</span></code> contains information about a trusted domain.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Account</span></code> contains information about a user, group, or local group account.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Private</span> <span class="pre">Data</span></code> contains protected information, such as server account passwords. This information is stored as encrypted strings.</p></li>
</ul>
<div class="section" id="policy-object">
<h2>Policy Object<a class="headerlink" href="#policy-object" title="Permalink to this headline">¶</a></h2>
<p>The Policy object is used to control access to the Local Security Authority (LSA) database and contains information that applies to the entire system or establishes defaults for the system. Each system has only one Policy object. This Policy object is created by the LSA when the system starts up, and applications cannot create or destroy it.</p>
</div>
<div class="section" id="trusteddomain-object">
<h2>TrustedDomain Object<a class="headerlink" href="#trusteddomain-object" title="Permalink to this headline">¶</a></h2>
<p>The TrustedDomain object stores information about a trust relationship with a domain. A TrustedDomain object is created on the trusting system to identify an account within the trusted domain that can be used to submit authentication requests and to perform other operations, such as name and security identifier (SID) translations.</p>
</div>
<div class="section" id="account-object">
<h2>Account Object<a class="headerlink" href="#account-object" title="Permalink to this headline">¶</a></h2>
<p>The Account object is used to assign privileges, system access, and special quotas to individual users or to members of local groups or groups.</p>
<div class="section" id="private-data-object">
<h3>Private Data Object<a class="headerlink" href="#private-data-object" title="Permalink to this headline">¶</a></h3>
<p>A limited number of private data objects are available on each system for the purpose of storing information in a protected, encrypted, fashion.</p>
<p>Private data objects are provided primarily to support storage of server account passwords. This is useful for servers that run in a specific account. The password of the server account is private data that should be secured but is needed to log the server on.</p>
<p>Private data objects may be general purpose, or they may be one of three specialized types: local, global, and machine.</p>
</div>
<div class="section" id="local-private-data-objects-l">
<h3>Local private data objects (L$)<a class="headerlink" href="#local-private-data-objects-l" title="Permalink to this headline">¶</a></h3>
<p>They can only be read locally from the computer storing the object. Attempting to read them remotely results in a STATUS_ACCESS_DENIED error. Local private data objects have key names that begin with the prefix “L$”. In addition to the local private objects you create, the operating system defines the following local private objects: $machine.acc, SAC, SAI, and SANSC.</p>
</div>
<div class="section" id="global-private-data-objects-g">
<h3>Global private data objects (G$)<a class="headerlink" href="#global-private-data-objects-g" title="Permalink to this headline">¶</a></h3>
<p>They are global in the sense that if they are created on a domain controller, they will be automatically replicated to all domain controllers in that domain. In other words, each domain controller in that domain will have access to the values the global private data object contains. In contrast, global private data objects created on a system that is not a domain controller, as well as nonglobal private data objects, are not replicated. Global private data objects have key names beginning with “G$”.</p>
<p>Examples:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">G$BCKUPKEY_PREFERRED</span></code> LSA secret: It contains key pair identifier (16-byte GUID) of object that holds the current modern key</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">G$BCKUPKEY_P</span></code> LSA secret: It contains GUID of object that holds the legacy key</p></li>
</ul>
</div>
<div class="section" id="machine-private-data-objects-m">
<h3>Machine private data objects (M$)<a class="headerlink" href="#machine-private-data-objects-m" title="Permalink to this headline">¶</a></h3>
<p>They can be accessed only by the operating system. These objects have key names that begin with “M$”.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "hunters-forge/ThreatHunter-Playbook",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "library"
        }
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2020.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.1.<br/>
    </p>
  </div>
</footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
  </body>
</html>